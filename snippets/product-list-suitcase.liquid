{% assign luggage_collection = collections['luggage'] %}

<div class="custom-select">
  <div class="select-label">CHANGE MODEL</div>

  <ul class="select-options">
    {% for product in luggage_collection.products %}
      <li data-url="{{ product.url }}">{{ product.title }}</li>
    {% endfor %}
  </ul>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const selectBox = document.querySelector('.custom-select');
  const selectOptions = selectBox.querySelector('.select-options');
  const optionItems = selectBox.querySelectorAll('.select-options li');

  // ðŸ”¥ Event delegation for ANY future .select-label
  document.body.addEventListener('click', (e) => {
    const clickedLabel = e.target.closest('.select-label');

      if (e.target.classList.contains('select-label')) {
      // If clicked on appended label
      const currentLabel = selectBox.querySelector('.select-label');

      currentLabel.classList.toggle('active');

      selectOptions.style.display =
        selectOptions.style.display === 'block' ? 'none' : 'block';
    }
  });

  // On clicking an option (li)
  optionItems.forEach(li => {
    li.addEventListener('click', () => {
      const currentLabel = selectBox.querySelector('.select-label');
      currentLabel.textContent = li.textContent;

      window.location.href = li.getAttribute('data-url');
    });
  });

  // Close outside
  document.addEventListener('click', (e) => {
    if (!e.target.closest('.custom-select')) {
      const currentLabel = selectBox.querySelector('.select-label');
      currentLabel.classList.remove('active');
      selectOptions.style.display = 'none';
    }
  });
});

</script>

<style>
.collection-pro-items .custom-select {
  position: relative;
  cursor: pointer;
  user-select: none;
  font-family: inherit;
}

.collection-pro-items .select-label {
  padding: 12px;
  border: 1px solid #ccc;
  background: #f8f8f8;
  font-weight: 600;
  position:relative;
  font-size: 14px;
}
.collection-pro-items .select-label:after {
    width: 10px;
    height: 10px;
    border: 0;
    transform-origin: 50% 50%;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Cpath stroke='%236D6E70' stroke-width='3px' d='M4.2,8.8l-1.4,1.4l12.5,12.5l0.7,0.7l0.7-0.7l12.5-12.5l-1.4-1.4L16,20.6L4.2,8.8z'/%3E%3C/svg%3E");
    position: absolute;
    right: 20px;
    content: "";
    top: 50%;
    transform: translateY(-50%) rotate(0deg);
    transition:all .3s ease;
}
.collection-pro-items .select-label.active:after {
    transform: translateY(-50%) rotate(180deg);
}
.collection-pro-items .select-options {
  display: none;
  position: absolute;
  width: 100%;
  max-height: 240px;
  overflow-y: auto;
  border: 1px solid #ccc;
  background: white;
  z-index: 20;
  margin-top: 2px;
  padding: 0;
  font-size: 14px;
}

.collection-pro-items .select-options li {
  padding: 12px;
  list-style: none;
}

.collection-pro-items .select-options li:hover {
  background: #efefef;
}
</style>